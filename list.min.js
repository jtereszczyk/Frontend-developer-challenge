const companiesList={init:()=>{const e=sessionStorage.getItem("table");e?(companiesList.sortEvents(),companiesList.sortList(e)):companiesList.fetchData()},fetchData:async()=>{try{const e=await fetch("https://dujour.squiz.cloud/developer-challenge/data",{method:"GET"}),t=await e.json(),s=JSON.stringify(t);sessionStorage.setItem("table",s),companiesList.sortList(s)}catch(e){return console.error(e),!1}companiesList.sortEvents()},createCompaniesList:e=>{const t=e;let s=[],n=[],r='<li class="list-headline"><span>Name</span><span>Country</span><span>Industry</span><span>No. of employees</span></li>';t.forEach(e=>{const t=e.name,i=e.country,o=e.industry,a=e.numberOfEmployees;r+=`<li class="list-item" data-country="ctry_${i}" data-industry="ind_${o}">\n        <span class="name">${t}</span>\n        <span class="country">${i}</span>\n        <span class="industry">${o}</span>\n        <span class="numberOfEmployees">${a}</span>\n      </li>\n      `,document.querySelectorAll("#filters input").length||(s.indexOf(o)<0&&s.push(o),n.indexOf(i)<0&&n.push(i))}),document.querySelectorAll("#filters input").length||companiesList.createFilters(s,n),document.querySelectorAll("#list ul")[0].innerHTML=r,companiesList.filterArray.length&&companiesList.filterSet(companiesList.filterArray)},sortEvents:()=>{function e(){this.querySelector(".chevron").classList.toggle("active"),this.classList.toggle("expanded")}function t(e){e.target!=n&&e.target.parentNode!=n&&e.target!=s&&(document.querySelector(".chevron").classList.remove("active"),document.querySelector("button.dropdown__btn").classList.remove("expanded"))}const s=document.querySelector("button.dropdown__btn"),n=document.querySelector("ul.dropdown__list");s.addEventListener("click",e),window.addEventListener("mouseup",t),document.querySelectorAll(".dropdown__list a").forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=this.getAttribute("href");companiesList.sortList(sessionStorage.getItem("table"),t)})})},sortList:(e,t)=>{switch(sort=JSON.parse(e),t){case"nameDesc":const s=sort.sort((e,t)=>e.name<t.name?1:-1);companiesList.createCompaniesList(s);break;case"nameAsc":const n=sort.sort((e,t)=>e.name>t.name?1:-1);companiesList.createCompaniesList(n);break;case"numberOfEmployeesDesc":const r=sort.sort((e,t)=>t.numberOfEmployees-e.numberOfEmployees);companiesList.createCompaniesList(r);break;case"numberOfEmployeesAsc":const i=sort.sort((e,t)=>e.numberOfEmployees-t.numberOfEmployees);companiesList.createCompaniesList(i);break;default:companiesList.createCompaniesList(sort)}},createFilters:(e,t)=>{let s="",n="";e.forEach(e=>{const t=e.replace(/\s/g,"_");s+=`<label class="filter__option" for="ind_${t}"><input type="checkbox" id="ind_${t}" />${e}</label>`}),document.querySelectorAll("#filters #filter-industry .filters__content")[0].innerHTML=s,t.forEach(e=>{const t=e.replace(/\s/g,"_");n+=`<label class="filter__option" for="ctry_${t}"><input type="checkbox" id="ctry_${t}" />${e}</label>`}),document.querySelectorAll("#filters #filter-country .filters__content")[0].innerHTML=n,companiesList.filtersEvents()},filtersEvents:()=>{document.querySelectorAll("#filters input").forEach(e=>{e.addEventListener("change",e=>{if(e.currentTarget.checked)companiesList.filterArray.push(e.currentTarget.id);else{const t=companiesList.filterArray.indexOf(e.currentTarget.id);t>-1&&companiesList.filterArray.splice(t,1)}companiesList.filterSet(companiesList.filterArray)})}),document.querySelectorAll(".filters__name").forEach(e=>{e.addEventListener("click",function(){this.classList.toggle("expanded"),this.querySelector(".chevron").classList.toggle("active")})})},filterSet:e=>{document.querySelectorAll("#list .list-item").forEach(t=>{if(!e.length)return void t.classList.remove("hidden");t.classList.add("hidden");const s=t.getAttribute("data-country").replace(/\s/g,"_"),n=t.getAttribute("data-industry").replace(/\s/g,"_");e.filter(/./.test,/ind_/).length&&e.filter(/./.test,/ctry_/).length?e.includes(s)&&e.includes(n)&&t.classList.remove("hidden"):(e.includes(s)||e.includes(n))&&t.classList.remove("hidden")})},filterArray:[]};companiesList.init();